<!DOCTYPE html>
<html lang="en" manifest="offline.manifest">
<head>
    <meta charset="UTF-8">
    <title>MWF DEMO</title>
    <!-- this tag avoids scaling the view on display -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1"/>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- for pwa, we may include the manifest
    <link rel="manifest" href="pwa/webapp-manifest.json"> -->
    <!-- framework + application style (shown by the IDE as not available as the file will be generated by the build process
         and placed next to the copy of this file in the dist directory -->
    <link rel="stylesheet" href="app-style.bundle.min.css"/>
    <!-- TODO: comment-in if mapviews shall be used. It seems that libs and css need to be accessed online rather than be provided locally, there is also some issue when using leaflet+offline manifest... -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <!-- framework + application js resources (also shown as not available, see above) -->
    <script type="module" src="app-js.bundle.min.js"></script>
</head>
<!-- TODO: change the application name if it is modified -->
<!-- 1. MWF erkennt hier, dass die Anwendung "MyApplication" heißt. "MyApplication" wird in der MyApplication.js geladen und oncreate() wird dann aufgerufen" -->
<body data-mwf-application="MyApplication" class="mwf-loading-app">

<!-- TODO-REPEATED: add new views here -->
<!-- 7. MWF sucht dann nach "mwf-view-initial". Diese View wird dann als erstes angezeigt. Gesteuert wird sie von ListviewViewController.
     Kann man sich merken wie... wenn diese View aktiv ist, dann soll die ListviewViewController alles steuern. -->
<div id="myapp-listview" class="mwf-view mwf-view-initial" data-mwf-viewcontroller="ListviewViewController">
    <header>
        <button class="mwf-imgbutton mwf-img-sandwich mwf-left-align mwf-img-sandwich-action"></button>
        <h1 class="mwf-left-align">Medien</h1>
        <button id="myapp-addNewItem" class="mwf-imgbutton mwf-img-plus mwf-right-align"></button>
    </header>
    <main class="mwf-scrollview">
        <!-- 9. "mwf-listview" ist hier sozusagen der Schalter, mit dem MWF gesagt wird, dass das eine Liste ist und automatisch zu befüllen ist. -->
        <ul class="mwf-listview" data-mwf-listitem-view="myapp-listitem" data-mwf-listitem-menu="myapp-mediaItemMenu">
            <!-- 10. Template mit dem Namen "myapp-listitem" wird gesucht. Für jedes MediaItem, dass aus readAll() ausgelesen wird,
            wird li-Template geclont (Klonkrieger) -->
            <li class="mwf-listitem mwf-li-title-subtitle mwf-template mwf-databind" data-mwf-templatename="myapp-listitem">
                <img class="mwf-left-align" src="{{src}}" />
                <div class="mwf-left-align mwf-li-titleblock">
                    <h2>{{title}} {{_id}}</h2>
                    <h3>{{addedDateString}}</h3>
                </div>
                <!-- NEU: Remote-Indikator außerhalb des Titleblocks -->
                <div class="mwf-left-align mwf-remote-label">
                    {{#if remote}} remote{{else}} lokal{{/if}}
                </div>
                <button class="mwf-imgbutton mwf-img-options-vertical mwf-right-align mwf-listitem-menu-control"></button>
            </li>

        </ul>
    </main>
    <footer>
        <button id="myapp-filter-toggle" class="mwf-button mwf-left-align">all</button>
        <button id="myapp-refresh-toggle" class="mwf-imgbutton mwf-img-refresh mwf-right-align"></button>
    </footer>
</div>
<div class="mwf-listitem-menu mwf-dialog mwf-popup mwf-template mwf-databind" data-mwf-templatename="myapp-mediaItemMenu">
    <header>
        <h2 class="mwf-dyncontent">{{title}} {{_id}}</h2>
    </header>
    <main>
        <ul>
            <li class="mwf-li-singletitle mwf-menu-item" data-mwf-targetaction="deleteItem">Delete {{_id}}</li>
            <li class="mwf-li-singletitle mwf-menu-item" data-mwf-targetaction="editItem">Edit {{_id}}</li>
        </ul>
    </main>
</div>
<div class="mwf-view" id="myapp-readview" data-mwf-viewcontroller="ReadviewViewController">
    <!-- {item: {title: "...", src:"...", _id: "..."}} -->
    <div class="mwf-template mwf-databind" data-mwf-templatename="myapp-readview-template">
        <header>
            <button class="mwf-imgbutton mwf-img-sandwich mwf-left-align mwf-img-sandwich-action"></button>
            <h1>{{item.title}} {{item._id}}</h1>
            <button on-click="deleteItem" class="mwf-imgbutton mwf-img-delete mwf-right-align"></button>
        </header>
        <main class="mwf-scrollview">
            <img src="{{item.src}}">
        </main>
        <footer>
            <button class="mwf-imgbutton mwf-img-backward mwf-left-align mwf-back"></button>
        </footer>
    </div>
</div>

<!-- edit dialog -->
<div class="mwf-dialog mwf-popup mwf-template mwf-databind mwf-view-component" data-mwf-templatename="myapp-mediaitem-dialog" data-mwf-viewcontroller="EditDialogViewController">
    <main>
        <h2>{{#if itemToBeEdited.created}}Medium editieren{{else}}Neues Medium{{/if}}</h2>

        <form on-submit="submitForm">

            <!-- Titel -->
            <fieldset class="mwf-material">
                <legend>Titel</legend>
                <input name="title" type="text" class="mwf-material-input" value="{{itemToBeEdited.title}}" required />
                <label class="mwf-material-altinput mwf-imgbutton mwf-img-camera" for="myapp-dialog-fileinput"></label>
            </fieldset>

            <!-- Bildauswahl -->
            <fieldset class="mwf-material">
                <input class="mwf-material-altinput" on-change="fileSelected"
                       type="file" id="myapp-dialog-fileinput" accept="image/*" />
            </fieldset>

            <!-- Vorschau mit schöner Darstellung -->
            <div class="mwf-img-container">
                <img src="{{itemToBeEdited.src}}" class="mwf-img-preview"/>
            </div>

            <!-- Speicherort -->
            <fieldset class="mwf-material">
                <label class="mwf-material-checkbox">
                    <input type="checkbox" id="myapp-remote-checkbox" checked="{{itemToBeEdited.remote}}" />
                    Bild remote speichern
                </label>
            </fieldset>

            <!-- Buttons -->
            <div class="mwf-buttonbar">
                <button type="button" on-click="deleteItem"
                        disabled="{{#unless itemToBeEdited.created}}disabled{{/unless}}"
                        class="mwf-button mwf-left-align">
                    Löschen
                </button>
                <input class="mwf-button mwf-button-prio mwf-right-align"
                       type="submit"
                       value="{{#if itemToBeEdited.created}}Ändern{{else}}Hinzufügen{{/if}}">
            </div>

        </form>
    </main>

</div>

<div class="mwf-dialog mwf-popup mwf-template mwf-databind mwf-view-component"
     data-mwf-templatename="myapp-delete-confirmation-dialog"
    data-mwf-viewcontroller="GenericDialogTemplateViewController">
    <header>
        <h2>MEDIUM LÖSCHEN</h2>
    </header>
    <main>
        <p>Möchten Sie das Medium {{item.title}} löschen?</p>
        <div class="mwf-buttonbar">
            <button class="mwf-button mwf-left-align" on-click="cancelDelete">Abbrechen</button>
            <button class="mwf-button mwf-button-prio mwf-right-align" on-click="confirmDelete">Löschen</button>
        </div>
    </main>
</div>


<!-- FRM -->
<div id="myapp-demo-view" class="mwf-view" data-mwf-viewcontroller="FRMDemoViewController">
    <div class="mwf-template mwf-databind" data-mwf-templatename="myapp-frm-demo-template">
        <header>
            <input class="mwf-imgbutton mwf-img-disk mwf-right-align" type="submit" value="submit" form="myapp-frm-demo-form"/>
        </header>
        <main>
            <form id="myapp-frm-demo-form" on-submit="submitForm">
                <fieldset class="mwf-material">
                    <legend>Image</legend>
                    <input name="imgsrc" type="text" required="required" value="{{item.title}}">
                    <input class="mwf-material-altinput" on-change="fileSelected" type="file" id="myapp-frm-demo-form-fileinput" />
                    <label class="mwf-material-altinput mwf-imgbutton mwf-img-camera" for="myapp-frm-demo-form-fileinput"></label>
                </fieldset>
                <input type="checkbox" checked="{{item.remote}}">
                <img src="{{item.src}}"/>
            </form>
        </main>
        <footer>
            <button class="mwf-imgbutton mwf-img-backward mwf-back mwf-left-align"></button>
        </footer>
    </div>
</div>

<div class="mwf-view" id="myapp-maps-demo" data-mwf-viewcontroller="MapsDemoViewController">
    <header>
        <button class="mwf-imgbutton mwf-img-sandwich mwf-left-align mwf-img-sandwich-action"></button>
        <h1>Maps Demo</h1>
    </header>
    <main>
        <div id="myapp-maproot"></div>
    </main>
    <footer></footer>
</div>

<div id="sidemenu" class="mwf-sidemenu mwf-view-component mwf-attaching mwf-initialise-onload" data-mwf-viewcontroller="SidemenuViewController">
    <ul>
        <li class="mwf-li-singletitle mwf-menu-item" data-mwf-id="mainmenu-items" data-mwf-targetview="myapp-listview">
            <div class="mwf-icon mwf-img-photo-album mwf-left-align"></div>
            <h2 class="mwf-left-align mwf-li-titleblock">Medien</h2>
        </li>
        <li class="mwf-li-singletitle mwf-menu-item" data-mwf-id="mainmenu-maps" data-mwf-targetview="myapp-maps-demo">
            <div class="mwf-icon mwf-img-map mwf-left-align"></div>
            <h2 class="mwf-left-align mwf-li-titleblock">Maps Demo</h2>
        </li>
    </ul>
</div>

</body>

</html>
